{"version":3,"sources":["order.js"],"names":["window","sr","reset","data","scrollTop","isSingnedin","currentPoint","_user","selectall","shopcar","computed","isShow","wHeight","innerHeight","document","documentElement","clientHeight","body","sumMoney","sum","i","len","length","money","allSum","methods","changePoint","index","cancel","id","findIndex","item","_id","arr","newShopCar","entries","value","push","console","log","post","send","update","end","err","res","error","status","payFor","toTop","_timer","setInterval","addr","clearInterval","_throttle","func","_start","that","args","arguments","apply","Date","now","aboutUs","_valiInput","username","password","email","gender","test","repeat","signup","self","title","html","confirmButtonText","showLoaderOnConfirm","preConfirm","resolve","reject","form","querySelector","elements","put","then","catch","msg","name","signin","isLogin","Error","user","buyVedio","ids","checked","ownedvedios","filters","getsum","watch","nV","mounted","reveal","addEventListener","e","get","query","populate","ResultList","$mount"],"mappings":"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","file":"../order.js","sourcesContent":["import Vue from 'vue/dist/vue.js'\nimport ScrollReveal from 'scrollreveal'\nimport swal from 'sweetalert2'\nimport request from 'superagent'\n\nwindow.sr = ScrollReveal({ reset: true })\n\nnew Vue({\n  data () {\n    return {\n      scrollTop: 0,\n      isSingnedin: false,\n      currentPoint: 0,\n      _user: {},\n      selectall: false,\n      shopcar: []\n    }\n  },\n  computed: {\n    isShow() {\n      const wHeight = window.innerHeight\n        || document.documentElement.clientHeight\n        || document.body.clientHeight\n\n      if (this.scrollTop - wHeight >= 0)\n        return true\n\n      return false\n    },\n    sumMoney() {\n      let sum = 0\n      for (let i = 0, len = this.shopcar.length; i < len; i++) {\n        sum += this.shopcar[i].money\n      }\n\n      return sum\n    },\n    allSum() {\n      return this.shopcar.length\n    }\n  },\n  methods: {\n    changePoint(index) {\n      this.currentPoint = index  \n    },\n    cancel(id) {\n      const index = this.shopcar.findIndex(item => item._id === id)\n\n      let arr = []\n      let newShopCar = []\n      for (let [i, value] of this.shopcar.entries()) {\n        if (index === i) continue\n\n        arr.push(value._id)\n        newShopCar.push(value)\n      }\n\n      console.log(arr)\n      request.post('/v1/api/user/users')\n        .send({\n          id: this._user._id,\n          update: {\n            shopcar: arr\n          }\n        })\n        .end((err, res) => {\n          if (err)\n            console.error(err)\n          else {\n            if (res.status === 201) {\n              swal('', '删除成功', 'success')\n              this.shopcar = newShopCar\n            }\n              \n          }\n        })\n    },\n    payFor() {\n      swal('', '请加QQ2080437116, :)', 'success')\n    },\n    toTop() {\n      let _timer = setInterval(function() {\n        const addr = document.body.scrollTop = document.body.scrollTop - 100\n        \n        if (addr <= 0) {\n          clearInterval(_timer)\n        }\n      }, 10)\n    },\n    _throttle(func, _timer = 100) {\n      let _start\n\n      return function() {\n        const that = this\n        const args = arguments\n\n        if (!_start) {\n          func.apply(this, args)\n\n          _start = Date.now()\n        } else {\n          if (Date.now() - _start > _timer) {\n            func.apply(this, args)\n\n            _start = Date.now()\n          }\n        }\n      }\n    },\n    aboutUs() {\n      swal('', 'QQ2080437116 ：）', 'success')\n    },\n    _valiInput(data) {\n      console.log(data.username.value)\n      console.log(data.password.value)\n      console.log(data.email.value)\n      console.log(data.gender.value)\n      if (!/^([a-zA-Z])[\\w\\W]{7,}/.test(data.username.value)) {\n        swal('', '请输入以字母开头，至少为7位的用户名', 'warning')\n        return false\n      }\n\n      if (data.repeat.value !== data.password.value) {\n        swal('', '请确保两次输入密码相同', 'warning')\n        return false\n      }\n\n      if (!/[\\w\\W]{7,}/.test(data.password.value)) {\n        swal('', '请输入至少为7为的密码', 'warning')\n        return false\n      }\n\n      if (!/^[\\w\\W]+@[\\w\\W]+.com$/.test(data.email.value)) {\n        swal('', '请输入正确的邮箱地址', 'warning')\n        return false\n      }\n\n      if (!data.gender.value) {\n        swal('', '请选择性别', 'warning')\n        return false\n      }\n\n      return true\n    },\n    signup() {\n      const self = this\n\n      swal({\n        title: '新账号注册',\n        html:\n          '<form id=\"signup-form\">' +\n            '<input type=\"text\" name=\"username\" class=\"swal2-input\" placeholder=\"用户名\"/>' + \n            '<input type=\"password\" name=\"password\" class=\"swal2-input\" placeholder=\"密码\"/>' + \n            '<input type=\"password\" name=\"repeat\" class=\"swal2-input\" placeholder=\"重复密码\"/>' + \n            '<input type=\"email\" name=\"email\" class=\"swal2-input\" placeholder=\"邮箱\"/>' +\n            '<div class=\"swal2-radio\">' +\n              '<label>' +\n                '<input type=\"radio\" id=\"gender\" name=\"gender\" value=\"0\"/><span>男</span>' +\n              '</label>' +\n              '<label>' +\n                '<input type=\"radio\" name=\"gender\" value=\"1\"/><span>女</span>' +\n              '</label>' +\n              '<label>' +\n                '<input type=\"radio\" name=\"gender\" value=\"2\"/><span>保密</span>' +\n              '</label>' +\n            '</div>' +\n          '</form>',\n        confirmButtonText: '注册',\n        showLoaderOnConfirm: true,\n        preConfirm() {\n          return new Promise((resolve, reject) => {\n            const form = document.querySelector('#signup-form').elements\n\n            if (self._valiInput(form))\n              request.put('/v1/api/user/user')\n                .send({\n                  username: form.username.value,\n                  password: form.password.value,\n                  email: form.email.value,\n                  gender: form.gender.value\n                })\n                .end((err, res) => {\n                  if (err)\n                    console.error(err)\n\n                  else {\n                    if (res.status === 201) {\n                      resolve()\n                    } else {\n                      reject('signup wrong')\n                    }\n                  }\n                })\n            else\n              reject()\n          })\n        }\n      }).then(() => {\n        swal('', '注册成功！:)', 'success')\n      }).catch(msg => {\n        if (msg === 'signup wrong')\n          swal('', '注册失败:(, 请稍后再试', 'wrong')\n      })\n\n      document.querySelector('#gender').name = 'gender'\n    },\n    signin() {\n      const self = this\n\n      swal({\n        title: '用户登录',\n        html:\n          '<form id=\"signup-form\">' +\n            '<input type=\"text\" name=\"username\" class=\"swal2-input\" placeholder=\"用户名/邮箱地址\"/>' + \n            '<input type=\"password\" name=\"password\" class=\"swal2-input\" placeholder=\"密码\"/>' + \n          '</form>',\n        confirmButtonText: '登录',\n        showLoaderOnConfirm: true,\n        preConfirm() {\n          return new Promise((resolve, reject) => {\n            const form = document.querySelector('#signup-form').elements\n\n            request.post('/v1/api/user/login')\n              .send({\n                username: form.username.value,\n                password: form.password.value\n              })\n              .end((err, res) => {\n                if (err)\n                  console.error(err)\n                else {\n                  resolve(res.body)\n                }\n              })\n          })\n        }\n      }).then(body => {\n        if (!body.isLogin)\n          swal('', body.Error, 'error')\n        else {\n          self._user = body.user\n          this.isSingnedin = true\n        }\n      })\n    },\n    buyVedio() {\n      let ids = []\n      let shopcar = []\n      let newShopCar = []\n      for (let item of this.shopcar) {\n        if (item.checked) {\n          ids.push(item._id)\n        } else {\n          newShopCar.push(item)\n          shopcar.push(item._id)\n        }\n      } \n\n      for (let id of ids) {\n        this._user.ownedvedios.push(id)\n      }\n\n      request.post('/v1/api/user/users')\n        .send({\n          id: this._user._id,\n          update: {\n            ownedvedios: this._user.ownedvedios,\n            shopcar: shopcar\n          }\n        })\n        .end((err, res) => {\n          if (err)\n            console.error(err)\n          else {\n            if (res.status === 201) {\n              swal('', '购买成功!请尽情享受吧', 'success')\n              this.shopcar = newShopCar\n            }\n          }\n        })\n      \n    }\n  },\n  filters: {\n    getsum(shopcar) {\n      let sum = 0\n      for (let item of shopcar) {\n        if (item.checked)\n          sum++\n      }\n\n      return sum\n    }\n  },\n  watch: {\n    selectall(nV) {\n      if (nV) {\n        for (let item of this.shopcar) {\n          item.checked = true\n        }\n      } else {\n        for (let item of this.shopcar) {\n          item.checked = false\n        }\n      }\n    }\n  },\n  mounted() {\n    const self = this\n    sr.reveal('.detail')\n\n    window.addEventListener('scroll', this._throttle(function(e) {\n      self.scrollTop = document.body.scrollTop\n    }, 50))\n\n    request.get('/v1/api/user/personal')\n      .end((err, res) => {\n        if (err)\n          console.error(err)\n        else {\n          if (res.body.isLogin) {\n            this._user = res.body.user\n            this.isSingnedin = true\n          \n            request.get('/v1/api/user/user/' + this._user._id)\n              .query({\n                populate: true\n              })\n              .end((err, res) => {\n                if (err)\n                  console.error(err)\n                else {\n                  this._user = res.body.ResultList[0]\n                  this.shopcar = this._user.shopcar\n                }\n              })\n          }\n        }\n      })\n\n  }\n}).$mount('#root')\n"]}