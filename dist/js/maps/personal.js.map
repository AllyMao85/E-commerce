{"version":3,"sources":["personal.js"],"names":["window","sr","reset","data","scrollTop","isSingnedin","user","ownVdeios","pageIndex","totaltimes","computed","isShow","wHeight","innerHeight","document","documentElement","clientHeight","body","methods","payFor","editUser","console","log","post","send","id","_id","update","name","job","gender","summary","end","err","res","error","toTop","_timer","setInterval","addr","clearInterval","goToOrder","location","href","_throttle","func","_start","that","args","arguments","apply","Date","now","aboutUs","_valiInput","username","value","password","email","test","repeat","signup","self","title","html","confirmButtonText","showLoaderOnConfirm","preConfirm","resolve","reject","form","querySelector","elements","put","status","then","catch","msg","signin","isLogin","Error","_initCourse","get","query","keys","populate","ResultList","ownedvedios","forEach","video","i","ids","children","join","totalTime","item","time","sss","hour","minute","second","changeAvatar","e","fileReader","FileReader","onload","avatar","result","Id","readAsDataURL","target","files","_initOrder","filters","fitGender","fitJob","watch","nV","oV","mounted","reveal","addEventListener","$mount"],"mappings":"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","file":"../personal.js","sourcesContent":["import Vue from 'vue/dist/vue.js'\nimport ScrollReveal from 'scrollreveal'\nimport swal from 'sweetalert2'\nimport request from 'superagent'\n\nwindow.sr = ScrollReveal({ reset: true })\n\nnew Vue({\n  data () {\n    return {\n      scrollTop: 0,\n      isSingnedin: false,\n      user: {},\n      ownVdeios: [],\n      pageIndex: 0,\n      totaltimes: []\n    }\n  },\n  computed: {\n    isShow() {\n      const wHeight = window.innerHeight\n        || document.documentElement.clientHeight\n        || document.body.clientHeight\n\n      if (this.scrollTop - wHeight >= 0)\n        return true\n\n      return false\n    }\n  },\n  methods: {\n    payFor() {\n      swal('', '请加QQ2080437116, :)', 'success')\n    },\n    editUser() {\n      console.log(this.user)\n\n      request.post('/v1/api/user/users')\n        .send({\n          id: this.user._id,\n          update: {\n            name: this.user.name,\n            job: this.user.job,\n            gender: this.user.gender,\n            summary: this.user.summary\n          }\n        })\n        .end((err, res) => {\n          if (err)\n            console.error(err)\n          else {\n            swal('', '修改成功', 'success')\n          }\n        })\n    },\n    toTop() {\n      let _timer = setInterval(function() {\n        const addr = document.body.scrollTop = document.body.scrollTop - 100\n        \n        if (addr <= 0) {\n          clearInterval(_timer)\n        }\n      }, 10)\n    },\n    goToOrder() {\n      window.location.href = '/order'\n    },\n    _throttle(func, _timer = 100) {\n      let _start\n\n      return function() {\n        const that = this\n        const args = arguments\n\n        if (!_start) {\n          func.apply(this, args)\n\n          _start = Date.now()\n        } else {\n          if (Date.now() - _start > _timer) {\n            func.apply(this, args)\n\n            _start = Date.now()\n          }\n        }\n      }\n    },\n    aboutUs() {\n      swal('', 'QQ2080437116 ：）', 'success')\n    },\n    _valiInput(data) {\n      console.log(data.username.value)\n      console.log(data.password.value)\n      console.log(data.email.value)\n      console.log(data.gender.value)\n      if (!/^([a-zA-Z])[\\w\\W]{7,}/.test(data.username.value)) {\n        swal('', '请输入以字母开头，至少为7位的用户名', 'warning')\n        return false\n      }\n\n      if (data.repeat.value !== data.password.value) {\n        swal('', '请确保两次输入密码相同', 'warning')\n        return false\n      }\n\n      if (!/[\\w\\W]{7,}/.test(data.password.value)) {\n        swal('', '请输入至少为7为的密码', 'warning')\n        return false\n      }\n\n      if (!/^[\\w\\W]+@[\\w\\W]+.com$/.test(data.email.value)) {\n        swal('', '请输入正确的邮箱地址', 'warning')\n        return false\n      }\n\n      if (!data.gender.value) {\n        swal('', '请选择性别', 'warning')\n        return false\n      }\n\n      return true\n    },\n    signup() {\n      const self = this\n\n      swal({\n        title: '新账号注册',\n        html:\n          '<form id=\"signup-form\">' +\n            '<input type=\"text\" name=\"username\" class=\"swal2-input\" placeholder=\"用户名\"/>' + \n            '<input type=\"password\" name=\"password\" class=\"swal2-input\" placeholder=\"密码\"/>' + \n            '<input type=\"password\" name=\"repeat\" class=\"swal2-input\" placeholder=\"重复密码\"/>' + \n            '<input type=\"email\" name=\"email\" class=\"swal2-input\" placeholder=\"邮箱\"/>' +\n            '<div class=\"swal2-radio\">' +\n              '<label>' +\n                '<input type=\"radio\" id=\"gender\" name=\"gender\" value=\"0\"/><span>男</span>' +\n              '</label>' +\n              '<label>' +\n                '<input type=\"radio\" name=\"gender\" value=\"1\"/><span>女</span>' +\n              '</label>' +\n              '<label>' +\n                '<input type=\"radio\" name=\"gender\" value=\"2\"/><span>保密</span>' +\n              '</label>' +\n            '</div>' +\n          '</form>',\n        confirmButtonText: '注册',\n        showLoaderOnConfirm: true,\n        preConfirm() {\n          return new Promise((resolve, reject) => {\n            const form = document.querySelector('#signup-form').elements\n\n            if (self._valiInput(form))\n              request.put('/v1/api/user/user')\n                .send({\n                  username: form.username.value,\n                  password: form.password.value,\n                  email: form.email.value,\n                  gender: form.gender.value\n                })\n                .end((err, res) => {\n                  if (err)\n                    console.error(err)\n\n                  else {\n                    if (res.status === 201) {\n                      resolve()\n                    } else {\n                      reject('signup wrong')\n                    }\n                  }\n                })\n            else\n              reject()\n          })\n        }\n      }).then(() => {\n        swal('', '注册成功！:)', 'success')\n      }).catch(msg => {\n        if (msg === 'signup wrong')\n          swal('', '注册失败:(, 请稍后再试', 'wrong')\n      })\n\n      document.querySelector('#gender').name = 'gender'\n    },\n    signin() {\n      const self = this\n\n      swal({\n        title: '用户登录',\n        html:\n          '<form id=\"signup-form\">' +\n            '<input type=\"text\" name=\"username\" class=\"swal2-input\" placeholder=\"用户名/邮箱地址\"/>' + \n            '<input type=\"password\" name=\"password\" class=\"swal2-input\" placeholder=\"密码\"/>' + \n          '</form>',\n        confirmButtonText: '登录',\n        showLoaderOnConfirm: true,\n        preConfirm() {\n          return new Promise((resolve, reject) => {\n            const form = document.querySelector('#signup-form').elements\n\n            request.post('/v1/api/user/login')\n              .send({\n                username: form.username.value,\n                password: form.password.value\n              })\n              .end((err, res) => {\n                if (err)\n                  console.error(err)\n                else {\n                  resolve(res.body)\n                }\n              })\n          })\n        }\n      }).then(body => {\n        if (!body.isLogin)\n          swal('', body.Error, 'error')\n        else {\n          self.user = body.user\n          this.isSingnedin = true\n        }\n      })\n    },\n    _initCourse() {\n      request.get('/v1/api/user/user/' + this.user._id)\n        .query({\n          keys: 'ownedvedios',\n          populate: true\n        })\n        .end((err, res) => {\n          if (err)\n            console.error(err)\n          else {\n            this.ownVdeios = res.body.ResultList[0].ownedvedios\n            \n            this.ownVdeios.forEach((video, i) => {\n              let ids = video.children.join('+')\n              if (ids) {\n                request.get('/v1/api/vedio/children')\n                  .query({\n                    ids \n                  })\n                  .end((err, res) => {\n                    if (err)\n                      console.error(err)\n                    else {\n                      let totalTime = 0\n\n                      res.body.ResultList.forEach(item => {\n                        totalTime += Number.parseInt(item.time)\n                      })\n                      console.log(totalTime)\n                      \n                      const sss = totalTime / 1000\n                    \n                      const hour = Number.parseInt(sss / 60 / 60)\n                      const minute = Number.parseInt((sss - hour * 60 * 60) / 60)\n                      const second = Number.parseInt(sss - hour * 60 * 60 - minute * 60)\n\n                      this.totaltimes[i] = `${hour}时${minute}分${second}秒`\n                    }\n                  })\n              } else {\n                this.totaltimes[i] = '0时0分0秒'\n              }\n            })\n          }\n        })\n\n    },\n    changeAvatar(e) {\n      const self = this\n      \n      let fileReader = new FileReader()\n      fileReader.onload = function() {\n        request.post('/v1/api/user/users')\n          .send({\n            id: self.user._id,\n            update: {\n              username: self.user.username,\n              avatar: this.result\n            }\n          })\n          .end((err, res) => {\n            if (err)\n              console.error(err)\n            else {\n              if (res.status === 201) {\n                swal('', '修改头像成功', 'success')\n                self.user.avatar = res.body.Id.avatar\n              }\n            }\n          })\n      }\n      fileReader.readAsDataURL(e.target.files[0])\n    },\n    _initOrder() {\n\n    }\n  },\n  filters: {\n    fitGender(gender) {\n      switch(gender) {\n        case 0:\n          return '男'\n        case 1:\n          return '女'\n        case 2:\n          return '保密'\n      }\n    },\n    fitJob(job) {\n      if (!job)\n        return '无业游民~'\n\n      return job\n    }\n  },\n  watch: {\n    pageIndex(nV, oV) {\n      switch(nV) {\n        case 1:\n          this._initCourse()\n          break\n        case 2:\n          this._initOrder()\n          break\n      }\n    }\n  },\n  mounted() {\n    const self = this\n    sr.reveal('.detail')\n\n    window.addEventListener('scroll', this._throttle(function(e) {\n      self.scrollTop = document.body.scrollTop\n    }, 50))\n\n    request.get('/v1/api/user/personal')\n      .end((err, res) => {\n        if (err)\n          console.error(err)\n        else {\n          if (res.body.isLogin) {\n            this.user = res.body.user\n            this.isSingnedin = true\n\n            console.log(this.user)\n            if (/course/.test('course')) {\n              this._initCourse()\n              this.pageIndex = 1\n            }\n          }\n        }\n      })\n\n  }\n}).$mount('#root')\n"]}